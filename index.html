<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Copyflix</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
<link rel="icon" type="image/png" href="favicon.png">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Inter',sans-serif;}
body{background:#0f0f0f;color:white;}

/* HEADER */
header{position:fixed;top:0;width:100%;height:70px;z-index:10;
display:flex;align-items:center;justify-content:space-between;
padding:0 40px;background:rgba(0,0,0,0.6);backdrop-filter:blur(10px);
transition:background 0.3s,box-shadow 0.3s;}
header.scrolled{background:#000;box-shadow:0 4px 15px rgba(0,0,0,.6);}
.logo{font-size:28px;font-weight:800;color:#e50914;}
nav{display:flex;gap:25px;}
nav a{color:white;text-decoration:none;font-weight:500;cursor:pointer;}
nav a:hover{color:#e50914;}
.header-right{display:flex;gap:10px;align-items:center;}

/* ADMIN BUTTON */
.admin-btn{padding:8px 16px;border:none;border-radius:5px;background:#e50914;color:white;font-weight:600;cursor:pointer;}
.admin-btn:hover{background:#f6121d;}

/* SEARCH */
.search-box{position:relative;}
.search-box input{background:rgba(255,255,255,0.1);border:none;border-radius:20px;padding:8px 15px 8px 35px;color:white;width:180px;transition:width 0.3s;}
.search-box input:focus{width:240px;outline:none;}
.search-box i{position:absolute;left:12px;top:50%;transform:translateY(-50%);color:#bbb;}

/* HERO */
.hero{
  height:45vh;margin-top:70px;
  background:linear-gradient(to bottom,rgba(0,0,0,.5),rgba(0,0,0,.95)),
             url("https://images.unsplash.com/photo-1524985069026-dd778a71c7b4") center/cover no-repeat;
  display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;
  padding:0 40px;
}
.hero h1{font-size:48px;margin-bottom:10px;}
.hero p{font-size:18px;max-width:650px;color:#ddd;line-height:1.4;}

/* CONTENT */
#content{margin-top:0;position:relative;z-index:2;padding-bottom:60px;}
#breadcrumb{padding:0 40px 10px;color:#aaa;font-size:14px;}
#backBtn{margin:0 40px 20px;background:#222;border:none;color:white;padding:8px 14px;display:none;border-radius:5px;cursor:pointer;transition:background 0.3s;}
#backBtn:hover{background:#333;}

/* GRID */
#grid{display:flex;flex-wrap:wrap;justify-content:center;gap:20px;padding:20px 40px;}
.card{background:#111;border-radius:12px;overflow:hidden;width:180px;cursor:pointer;transition:transform 0.3s,box-shadow 0.3s;}
.card:hover{transform:scale(1.05);box-shadow:0 8px 20px rgba(0,0,0,0.7);}
.card img{width:100%;height:270px;object-fit:cover;}
.card-title{text-align:center;padding:12px;font-size:14px;font-weight:500;}
.folder{border:2px solid #e50914;}

/* FOOTER */
footer{text-align:center;padding:30px;color:#999;background:black;}

/* RESPONSIVE */
@media(max-width:768px){
  header{padding:0 20px;}
  .hero h1{font-size:36px;}
  .hero p{font-size:16px; max-width:90%;}
  #grid{gap:15px;}
  .card{width:140px;}
  .card img{height:210px;}
  .search-box input{width:140px;}
  .search-box input:focus{width:180px;}
}
</style>
</head>

<body>

<header>
  <div class="logo">COPYFLIX</div>
  <nav>
    <a onclick="setFilter('all')">Accueil</a>
    <a onclick="setFilter('film')">Films</a>
    <a onclick="setFilter('serie')">Séries</a>
  </nav>
  <div class="header-right">
    <div class="search-box">
      <i class="fa-solid fa-magnifying-glass"></i>
      <input type="text" id="searchInput" placeholder="Rechercher...">
    </div>
    <button class="admin-btn" onclick="window.open('admin/login.html','_blank')">Admin</button>
  </div>
</header>

<section class="hero">
  <h1>Bienvenue sur Copyflix</h1>
  <p>Ta plateforme privée de films et séries.<br>Simple. Moderne. Efficace.</p>
</section>

<section id="content">
  <button id="backBtn">⬅ Retour</button>
  <div id="grid"></div>
</section>

<footer>© 2025 Copyflix</footer>

<script>
// HEADER SCROLL EFFECT
const header=document.querySelector("header");
window.addEventListener("scroll",()=>header.classList.toggle("scrolled",scrollY>50));

// INITIALISATION DES DONNÉES DE TEST
if(!localStorage.getItem("copyflixData")){
  localStorage.setItem("copyflixData", JSON.stringify({
    "folders":[
      {
        "id":"dossier1",
        "title":"Pirates de Caraïbes",
        "type":"Folder",
        "image":"https://via.placeholder.com/300x450?text=Trilogie",
        "children":[
          {
            "id":"film1",
            "title":"Pirates 1",
            "type":"film",
            "image":"https://via.placeholder.com/300x450?text=Pirates+1",
            "video":"https://example.com/video1.mp4"
          },
          {
            "id":"film2",
            "title":"Pirates 2",
            "type":"film",
            "image":"https://via.placeholder.com/300x450?text=Pirates+2",
            "video":"https://example.com/video2.mp4"
          }
        ]
      }
    ],
    "films":[
      {
        "id":"racine1",
        "title":"Film Test",
        "type":"film",
        "image":"https://via.placeholder.com/300x450?text=Film+Test",
        "video":"https://example.com/video.mp4"
      },
      {
        "id":"racine2",
        "title":"Série Test",
        "type":"serie",
        "image":"https://via.placeholder.com/300x450?text=Série+Test",
        "video":"https://example.com/video2.mp4"
      }
    ]
  }));
}

const grid=document.getElementById("grid");
const backBtn=document.getElementById("backBtn");
const searchInput=document.getElementById("searchInput");
const data=JSON.parse(localStorage.getItem("copyflixData"));
let historyStack=[];
let currentFilter='all';

// UTILITAIRES
function normalizeType(t){ return t? t.toLowerCase().replace(/é/g,"e") : ""; }
function hasTypeInChildren(folder,type){
  if(!folder.children) return false;
  for(let c of folder.children){
    if(normalizeType(c.type)===type) return true;
    if(c.children && hasTypeInChildren(c,type)) return true;
  }
  return false;
}

// FILTRAGE DOSSIERS ET FILMS
function getVisibleFolders(searchTerm=""){
  let folders = currentFilter==='all'? data.folders : data.folders.filter(f=>hasTypeInChildren(f,currentFilter));
  if(searchTerm) folders = folders.filter(f=>f.title.toLowerCase().includes(searchTerm));
  return folders;
}
function getVisibleFilms(searchTerm=""){
  let films = currentFilter==='all'? data.films : data.films.filter(f=>normalizeType(f.type)===currentFilter);
  if(searchTerm) films = films.filter(f=>f.title.toLowerCase().includes(searchTerm));
  return films;
}

// RENDER
function renderRoot(searchTerm=""){
  historyStack=[];
  backBtn.style.display="none";
  renderItems(getVisibleFolders(searchTerm),getVisibleFilms(searchTerm));
}

function renderItems(folders=[],films=[]){
  grid.innerHTML="";
  folders.forEach(f=>renderFolder(f));
  films.forEach(f=>renderFilm(f));
}

// CARDS
function renderFolder(folder){
  const card=document.createElement("div");
  card.className="card folder";
  card.innerHTML=`<img src="${folder.image||'https://via.placeholder.com/300x450?text=Dossier'}"><div class="card-title">${folder.title}</div>`;
  card.onclick=()=>openFolder(folder);
  grid.appendChild(card);
}

function renderFilm(film){
  const card=document.createElement("div");
  card.className="card";
  card.innerHTML=`<img src="${film.image||'https://via.placeholder.com/300x450?text=Film'}"><div class="card-title">${film.title}</div>`;
  card.onclick=()=>window.open(film.video,"_blank");
  grid.appendChild(card);
}

// NAVIGATION DOSSIERS
function openFolder(folder){
  historyStack.push(folder);
  backBtn.style.display="block";
  renderItems(
    folder.children?.filter(i=>i.type==="Folder")||[],
    folder.children?.filter(i=>i.type!=="Folder")||[]
  );
}

backBtn.onclick=()=>{
  historyStack.pop();
  if(historyStack.length===0){renderRoot();return;}
  const folder=historyStack[historyStack.length-1];
  renderItems(
    folder.children?.filter(i=>i.type==="Folder")||[],
    folder.children?.filter(i=>i.type!=="Folder")||[]
  );
}

// FILTRE
function setFilter(type){
  currentFilter=type==='serie'?'serie':type==='film'?'film':'all';
  renderRoot(searchInput.value.toLowerCase());
}

// RECHERCHE
searchInput.addEventListener("input",()=> {
  const term=searchInput.value.toLowerCase();
  if(historyStack.length>0){
    const folder=historyStack[historyStack.length-1];
    const folders=folder.children?.filter(i=>i.type==="Folder" && i.title.toLowerCase().includes(term))||[];
    const films=folder.children?.filter(i=>i.type!=="Folder" && i.title.toLowerCase().includes(term))||[];
    renderItems(folders,films);
  } else {
    renderRoot(term);
  }
});

// INITIAL RENDER
renderRoot();
</script>

</body>
</html>
